services:
    _defaults:
        autowire: true
        autoconfigure: true
        public: false

        bind:
            $commandBus: '@messenger.bus.commands'
            $eventBus: '@messenger.bus.events'

    Xm\SymfonyBundle\Command\CreateEventStreamCommand: ~
    Xm\SymfonyBundle\Command\GraphQlDumpSchemaCommand: ~
    Xm\SymfonyBundle\Command\ProjectionRunCommand: ~
    Xm\SymfonyBundle\Command\PurgeCloudflareCacheCommand: ~

    Xm\SymfonyBundle\Messenger\CommandEnricherMiddleware: ~
    Xm\SymfonyBundle\Messenger\CommandRecorderMiddleware: ~
    Xm\SymfonyBundle\Messenger\FailureCatcherMiddleware: ~

    Xm\SymfonyBundle\DataProvider\IssuerProvider: ~

    Xm\SymfonyBundle\Security\TokenGenerator: ~
    Xm\SymfonyBundle\Security\TokenGeneratorInterface: '@Xm\SymfonyBundle\Security\TokenGenerator'

    Xm\SymfonyBundle\Security\PasswordEncoder: ~
    Xm\SymfonyBundle\Security\UserChecker: ~
    App\Security\TokenValidator: ~

    Xm\SymfonyBundle\EventSourcing\Aggregate\RepositoryFactory: ~

    Xm\SymfonyBundle\EventSourcing\Aggregate\AggregateRepository:
        abstract: true
        factory: 'Xm\SymfonyBundle\EventSourcing\Aggregate\RepositoryFactory:create'

    Xm\SymfonyBundle\EventSourcing\Aggregate\AggregateTranslator: ~
    Xm\SymfonyBundle\EventStore\PersistenceStrategy\StreamStrategy: ~

    Xm\SymfonyBundle\EventStore\MetadataIssuedByEnricher:
        tags: [ 'prooph_event_store.metadata_enricher' ]

    Xm\SymfonyBundle\EventStore\EventStoreMessengerPlugin:
        tags: [ 'prooph_event_store.plugin' ]

    Xm\SymfonyBundle\Infrastructure\GraphQl\Type\:
        resource: '../../Infrastructure/GraphQl/Type/*Type.php'
        tags: [ 'overblog_graphql.type' ]

    Xm\SymfonyBundle\Infrastructure\GraphQl\Resolver\:
        resource: '../../Infrastructure/GraphQl/Resolver/*/*Resolver.php'
        tags: [ 'overblog_graphql.resolver' ]
